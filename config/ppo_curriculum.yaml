# TEAM-BASED CURRICULUM: Proper progression for cooperative multi-agent learning
shared:
  n_steps: 2048
  batch_size: 64
  n_epochs: 10
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2
  vf_coef: 0.5
  max_grad_norm: 0.5
  num_agents_team_a: 2
  num_agents_team_b: 0  # No opponents in phase 1-2
  device: "cpu"
  hidden_dim: 128
  log_interval: 5
  save_interval: 25
  checkpoint_dir: "checkpoints"
  log_dir: "logs"

# ========================================
# PHASE 1: Learn to HIT puck (any direction)
# ========================================
phase_1:
  name: "learn_hitting"
  timesteps: 100000
  opponent_type: "static"
  max_score: 100  # Don't end on goals - we want hitting practice
  max_steps: 600  # Short episodes for fast iteration
  learning_rate: 0.001
  ent_coef: 0.20  # VERY high exploration
  clip_range: 0.3  # Wide exploration
  rewards:
    # Phase 1: ONLY contact matters, direction doesn't matter yet
    approach_puck_in_half: 0.0
    close_to_puck: 0.0
    puck_velocity_toward_goal: 0.0  # Don't care about direction yet
    defensive_position: 0.0
    center_coverage: 0.0
    action_penalty: 0.0
    unnecessary_movement: 0.0
    teammate_collision: 0.0
    # Reward comes from: 20 for any hit (via contact detection)

# ========================================
# PHASE 2: Learn to SHOOT toward goal
# ========================================
phase_2:
  name: "learn_shooting"
  timesteps: 150000
  opponent_type: "static"
  max_score: 1  # End after first goal (fast feedback)
  max_steps: 800
  learning_rate: 0.0008
  ent_coef: 0.15
  clip_range: 0.2
  rewards:
    # Phase 2: Now direction matters
    # Contact reward: 20 (from code)
    # Shooting reward: up to 80 (from code, if puck_vx > 0)
    # Goal reward: 1000 (shared by team)
    approach_puck_in_half: 0.0
    close_to_puck: 0.0
    puck_velocity_toward_goal: 0.0
    defensive_position: 0.0
    center_coverage: 0.0
    action_penalty: 0.0
    unnecessary_movement: 0.0
    teammate_collision: 0.1  # Small penalty to avoid bumping

# ========================================
# PHASE 3: Learn TEAMWORK (2v1)
# ========================================
phase_3:
  name: "learn_teamwork"
  timesteps: 150000
  opponent_type: "simple"
  max_score: 3
  max_steps: 1200
  learning_rate: 0.0005
  ent_coef: 0.10
  clip_range: 0.2
  rewards:
    # Phase 3: Add slight positioning rewards
    # Goal reward is SHARED, so both agents benefit from assists
    approach_puck_in_half: 0.0
    close_to_puck: 0.0
    puck_velocity_toward_goal: 0.0
    defensive_position: 0.1  # Start caring about defense
    center_coverage: 0.1
    action_penalty: 0.0
    unnecessary_movement: 0.0
    teammate_collision: 0.2

# ========================================
# PHASE 4: Learn FULL GAME (2v2)
# ========================================
phase_4:
  name: "full_game"
  timesteps: 200000
  opponent_type: "mixed"
  max_score: 5
  max_steps: 1800
  learning_rate: 0.0003
  ent_coef: 0.05
  clip_range: 0.2
  rewards:
    approach_puck_in_half: 0.0
    close_to_puck: 0.0
    puck_velocity_toward_goal: 0.0
    defensive_position: 0.2
    center_coverage: 0.2
    action_penalty: 0.0001
    unnecessary_movement: 0.005
    teammate_collision: 0.3