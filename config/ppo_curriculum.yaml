# ============================================
# UNIFIED PPO TRAINING CONFIG
# Used by both train_ppo.py and train_ppo_curriculum.py
# ============================================

# Shared base configuration
shared:
  n_steps: 2048
  batch_size: 128
  n_epochs: 6
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2
  clip_range_vf: 0.2
  vf_coef: 0.5
  max_grad_norm: 0.5
  num_agents_team_a: 2
  num_agents_team_b: 2
  device: "cpu"
  hidden_dim: 128
  log_interval: 10
  save_interval: 50
  checkpoint_dir: "checkpoints"
  log_dir: "logs"

# ============================================
# STANDARD TRAINING (for train_ppo.py)
# Single phase, non-curriculum training
# ============================================
standard:
  name: "standard_training"
  total_timesteps: 1000000
  opponent_type: "simple"
  max_score: 3
  max_steps: 1200
  learning_rate: 0.0003
  ent_coef: 0.01
  clip_range: 0.2
  
  rewards:
    # Offensive rewards
    goal_scored: 1000.0
    goal_conceded: -1000.0
    approach_puck: 5.0
    proximity_to_puck: 20.0
    contact_puck: 100.0
    shoot_toward_goal: 200.0
    
    # Defensive rewards
    defensive_position: 0.03
    center_coverage: 0.02
    
    # Penalties
    teammate_collision: 0.1
    action_penalty: 0.0
    unnecessary_movement: 0.0

# ============================================
# CURRICULUM PHASES (for train_ppo_curriculum.py)
# Progressive learning over multiple phases
# ============================================

phase_0:
  name: "learn_contact"
  timesteps: 100000
  opponent_type: "static"
  max_score: 100
  max_steps: 400  # Short episodes
  learning_rate: 0.001
  ent_coef: 0.05  # Lower entropy from start
  clip_range: 0.3  # Allow bigger updates
  
  rewards:
    goal_scored: 100.0
    goal_conceded: 0.0
    approach_puck: 5.0
    proximity_to_puck: 10.0  # Reduced
    contact_puck: 500.0  # HUGE contact reward
    shoot_toward_goal: 50.0
    # Everything else OFF
    field_coverage: 0.0
    defensive_position: 0.0
    transition_speed: 0.0
    center_coverage: 0.0
    teammate_collision: 0.0
    action_penalty: 0.0
    unnecessary_movement: 0.0

# Phase 1: JUST LEARN TO HIT THE PUCK
phase_1:
  name: "learn_puck_interaction"
  timesteps: 200000  # More time on basics
  opponent_type: "static"
  max_score: 10  # Allow some goals
  max_steps: 800
  learning_rate: 0.0005  # More conservative
  ent_coef: 0.1  # Less exploration
  clip_range: 0.2
  
  rewards:
    # Focus ONLY on puck interaction
    goal_scored: 500.0
    goal_conceded: 0.0  # No penalty yet
    approach_puck: 15.0
    proximity_to_puck: 40.0
    contact_puck: 200.0
    shoot_toward_goal: 300.0
    # Everything else OFF
    field_coverage: 0.0
    defensive_position: 0.0
    transition_speed: 0.0
    center_coverage: 0.0
    teammate_collision: -2.0
    action_penalty: 0.0
    unnecessary_movement: 0.0

# Phase 2: Add basic positioning
phase_2:
  name: "learn_positioning"
  timesteps: 150000
  opponent_type: "random"
  max_score: 5
  max_steps: 1200
  learning_rate: 0.0003
  ent_coef: 0.05
  
  rewards:
    goal_scored: 750.0
    goal_conceded: -300.0  # Small penalty
    approach_puck: 12.0
    proximity_to_puck: 35.0
    contact_puck: 180.0
    shoot_toward_goal: 280.0
    # Gradually introduce positioning
    field_coverage: 5.0  # Very small
    defensive_position: 3.0  # Very small
    transition_speed: 2.0
    center_coverage: 2.0
    teammate_collision: -3.0
    action_penalty: -0.0005
    unnecessary_movement: -0.001

# Phase 3: Full game
phase_3:
  name: "full_game"
  timesteps: 200000
  opponent_type: "simple"
  max_score: 5
  max_steps: 1500
  learning_rate: 0.0001
  ent_coef: 0.02
  
  rewards:
    goal_scored: 1000.0
    goal_conceded: -1000.0
    approach_puck: 10.0
    proximity_to_puck: 30.0
    contact_puck: 150.0
    shoot_toward_goal: 250.0
    # Moderate positioning
    field_coverage: 15.0
    defensive_position: 10.0
    transition_speed: 8.0
    center_coverage: 8.0
    teammate_collision: -5.0
    action_penalty: -0.001
    unnecessary_movement: -0.005